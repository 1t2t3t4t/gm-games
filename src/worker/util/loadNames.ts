import type { PlayerBioInfoProcessed } from "../../common/types";
import defaultDefaultColleges from "../data/defaultColleges";
import defaultCountries from "../data/defaultCountries";
import g from "./g";

// The names were generated by tools/names.js, you probably don't want to edit them by hand.
// If the list of countries changes, update the fake age code in getPlayerFakeAge.js!
// This is dynamically resolved with rollup-plugin-alias
import names from "player-names"; // eslint-disable-line
const defaultNames = (names as unknown) as Record<
	string,
	{
		first: Record<string, number>;
		last: Record<string, number>;
		percentSkipCollege?: number;
	}
>;

const toCumSumArray = (obj: Record<string, number>): [string, number][] => {
	let cumsum = 0;
	return Object.entries(obj).map(([key, value]) => {
		cumsum += value;
		return [key, cumsum];
	});
};

const loadNames = (): PlayerBioInfoProcessed => {
	const gPlayerBioInfo = g.get("playerBioInfo");
	if (gPlayerBioInfo) {
	} else {
		/*const gNames = g.get("names");
		if (gNames) {
			// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions
			if (gNames.first) {
				if (Array.isArray(gNames.first)) {
					first = {
						USA: gNames.first,
					};
				} else {
					first = gNames.first;
				}
			}

			// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions
			if (gNames.last) {
				if (Array.isArray(gNames.last)) {
					last = {
						USA: gNames.last,
					};
				} else {
					last = gNames.last;
				}
			}
		}*/
	}

	const names: PlayerBioInfoProcessed["names"] = {};

	for (const [country, info] of Object.entries(defaultNames)) {
		names[country] = {
			first: toCumSumArray(info.first),
			last: toCumSumArray(info.last),
		};

		if (info.colleges) {
			names[country].colleges = toCumSumArray(info.colleges);
		}

		if (info.percentSkipCollege !== undefined) {
			names[country].percentSkipCollege = info.percentSkipCollege;
		}
	}

	return {
		countries: toCumSumArray(defaultCountries),
		defaultColleges: toCumSumArray(defaultDefaultColleges),
		names,
	};
};

export default loadNames;
